<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Check Local Network</title>
</head>
<body>
  <p id="status">Checking your connection...</p>

  <script>
    const localFaviconUrl = "http://tv.clinics.local/favicon.ico";
    const statusEl = document.getElementById('status');

    function checkLocalServer() {
      return new Promise((resolve, reject) => {
        const img = new Image();

        img.onload = () => resolve(true);  // favicon loaded - local server reachable
        img.onerror = () => reject(false); // failed to load - probably not connected

        img.src = localFaviconUrl + "?_=" + Date.now(); // cache buster
      });
    }

    checkLocalServer()
      .then(() => {
        // Redirect immediately if favicon loads
        window.location.href = "http://tv.clinics.local/topic_selector";
      })
      .catch(() => {
        // Show message if failed
        statusEl.innerHTML = `
          <strong>Oops!</strong> Please connect to the local Wi-Fi network to access the TV service.<br />
          Then <a href="http://tv.clinics.local/topic_selector">click here to continue</a>.
        `;
      });
  </script>
</body>
</html>
